ERRMSG 20 WHERE NOT EXISTS(
SELECT 'X' FROM ZCLA_CONTRACTSTATUSE WHERE INITFLAG = 'Y')
;
ERRMSG 21 WHERE NOT EXISTS
(SELECT 'X' FROM ZCLA_CONTRACTSTATUSE
WHERE ZCLA_CONTRACTSTATUSE.CANCELSTAT = 'Y')
;
SELECT ZCLA_CONTRACTSTATUSE.STEPSTATUSDES INTO :PAR1
FROM ZCLA_CONTRACTSTATUSE , DOCSTATUSES
WHERE ZCLA_CONTRACTSTATUSE.CANCELSTAT = 'Y'
AND DOCSTATUSES.TYPE = '<'
AND ZCLA_CONTRACTSTATUSE.STEPSTATUS = DOCSTATUSES.ORIGSTATUSID
AND DOCSTATUSES.INACTIVE = 'Y';
ERRMSG 23 WHERE :RETVAL > 0
;
SELECT MAX(ZCLA_CONTRACTSTATUSE.STEPSTATUSDES),
MIN(ZCLA_CONTRACTSTATUSE.STEPSTATUSDES), COUNT(*)
INTO :PAR1, :PAR2, :COUNT
FROM ZCLA_CONTRACTSTATUSE
WHERE ZCLA_CONTRACTSTATUSE.CANCELSTAT = 'Y'
HAVING COUNT(*) > 1;
ERRMSG 22 WHERE :RETVAL > 0
;
/**** InactiveFlag and FinalFlag of CloseStat ****/
DECLARE INACT@ CURSOR FOR SELECT
ZCLA_CONTRACTSTATUSE.STEPSTATUSDES, ZCLA_CONTRACTSTATUSE.CLOSESTATUS
FROM ZCLA_CONTRACTSTATUSE, DOCSTATUSES
WHERE DOCSTATUSES.TYPE = '<'
AND ZCLA_CONTRACTSTATUSE.STEPSTATUS = DOCSTATUSES.ORIGSTATUSID
AND DOCSTATUSES.INACTIVE <> 'Y'
AND ZCLA_CONTRACTSTATUSE.CLOSESTATUS <> 0;
OPEN INACT@;
GOTO 1 WHERE :RETVAL <= 0;
LABEL 2;
:CLOSESTATUS = 0;
:PAR1 = :PAR2 = '';
FETCH INACT@ INTO :PAR1, :CLOSESTATUS;
GOTO 3 WHERE :RETVAL <= 0;
SELECT ZCLA_CONTRACTSTATUSE.STEPSTATUSDES INTO :PAR2
FROM ZCLA_CONTRACTSTATUSE, DOCSTATUSES
WHERE ZCLA_CONTRACTSTATUSE.STEPSTATUS = DOCSTATUSES.ORIGSTATUSID
AND ZCLA_CONTRACTSTATUSE.STEPSTATUS = :CLOSESTATUS
AND DOCSTATUSES.TYPE = '<'
AND DOCSTATUSES.INACTIVE = 'Y';
ERRMSG 24 WHERE :RETVAL > 0
;
SELECT STEPSTATUSDES INTO :PAR2 FROM ZCLA_CONTRACTSTATUSE
WHERE STEPSTATUS = :CLOSESTATUS
AND CLOSEFLAG <> 'Y';
ERRMSG 25 WHERE :RETVAL > 0
;
LOOP 2;
LABEL 3;
CLOSE INACT@;
LABEL 1;
