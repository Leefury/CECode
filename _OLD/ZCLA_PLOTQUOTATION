/* KemalY |  Insert all plot fix sums to ZCLA_PLOTSUMPERFIX for
report */
:DOC = ATOI(:HTMLVALUE);
/* Table Links */
/*
LINK DOCUMENTS TO :$.PAR;
GOTO 999 WHERE :RETVAL <= 0;
*/
LINK ZCLA_PLOTSUMPERFIX TO :$.CLA;
GOTO 999 WHERE :RETVAL <= 0;
/* Select All Plot Sums Per Fix */
DECLARE PLOTCURSOR CURSOR FOR
SELECT DISTINCT ZCLA_PLOT
FROM PROJACTS A 
WHERE A.DOC = :DOC
AND A.LEVEL = 3
;
OPEN PLOTCURSOR;
GOTO 999 WHERE :RETVAL <= 0;
LABEL 111;
:PLOT = 0;
FETCH PLOTCURSOR INTO :PLOT;
GOTO 999 WHERE :RETVAL <= 0
;
:FIX1 = :FIX2 = :FIX3 = :FIX4 = :FIX5 = 0.00;
:FIX6 = :FIX7 = :FIX8 = :FIX9 = :FIX10 = 0.00;
SELECT ZCLA_TRAVEL + ZCLA_LABTOTAL + ZCLA_PARTSUM + ZCLA_MILEAGE +
ZCLA_SUNDRY
INTO :FIX1
FROM PROJACTS A 
WHERE A.DOC = :DOC
AND A.LEVEL = 3
AND ZCLA_PLOT = :PLOT
AND ZCLA_FIX = 1
;
SELECT ZCLA_TRAVEL + ZCLA_LABTOTAL + ZCLA_PARTSUM + ZCLA_MILEAGE +
ZCLA_SUNDRY
INTO :FIX2
FROM PROJACTS A 
WHERE A.DOC = :DOC
AND A.LEVEL = 3
AND ZCLA_PLOT = :PLOT
AND ZCLA_FIX = 2
;
SELECT ZCLA_TRAVEL + ZCLA_LABTOTAL + ZCLA_PARTSUM + ZCLA_MILEAGE +
ZCLA_SUNDRY
INTO :FIX3
FROM PROJACTS A
WHERE A.DOC = :DOC
AND A.LEVEL = 3
AND ZCLA_PLOT = :PLOT
AND ZCLA_FIX = 3
;
SELECT ZCLA_TRAVEL + ZCLA_LABTOTAL + ZCLA_PARTSUM + ZCLA_MILEAGE +
ZCLA_SUNDRY
INTO :FIX4
FROM PROJACTS A 
WHERE A.DOC = :DOC
AND A.LEVEL = 3
AND ZCLA_PLOT = :PLOT
AND ZCLA_FIX = 4
;
SELECT ZCLA_TRAVEL + ZCLA_LABTOTAL + ZCLA_PARTSUM + ZCLA_MILEAGE +
ZCLA_SUNDRY
INTO :FIX5
FROM PROJACTS A 
WHERE A.DOC = :DOC
AND A.LEVEL = 3
AND ZCLA_PLOT = :PLOT
AND ZCLA_FIX = 5
;
SELECT ZCLA_TRAVEL + ZCLA_LABTOTAL + ZCLA_PARTSUM + ZCLA_MILEAGE +
ZCLA_SUNDRY
INTO :FIX6
FROM PROJACTS A 
WHERE A.DOC = :DOC
AND A.LEVEL = 3
AND ZCLA_PLOT = :PLOT
AND ZCLA_FIX = 6
;
SELECT ZCLA_TRAVEL + ZCLA_LABTOTAL + ZCLA_PARTSUM + ZCLA_MILEAGE +
ZCLA_SUNDRY
INTO :FIX7
FROM PROJACTS A 
WHERE A.DOC = :DOC
AND A.LEVEL = 3
AND ZCLA_PLOT = :PLOT
AND ZCLA_FIX = 7
;
SELECT ZCLA_TRAVEL + ZCLA_LABTOTAL + ZCLA_PARTSUM + ZCLA_MILEAGE +
ZCLA_SUNDRY
INTO :FIX8
FROM PROJACTS A 
WHERE A.DOC = :DOC
AND A.LEVEL = 3
AND ZCLA_PLOT = :PLOT
AND ZCLA_FIX = 8
;
SELECT ZCLA_TRAVEL + ZCLA_LABTOTAL + ZCLA_PARTSUM + ZCLA_MILEAGE +
ZCLA_SUNDRY
INTO :FIX9
FROM PROJACTS A 
WHERE A.DOC = :DOC
AND A.LEVEL = 3
AND ZCLA_PLOT = :PLOT
AND ZCLA_FIX = 9
;
SELECT ZCLA_TRAVEL + ZCLA_LABTOTAL + ZCLA_PARTSUM + ZCLA_MILEAGE +
ZCLA_SUNDRY
INTO :FIX10
FROM PROJACTS A 
WHERE A.DOC = :DOC
AND A.LEVEL = 3
AND ZCLA_PLOT = :PLOT
AND ZCLA_FIX = 10
;
INSERT INTO ZCLA_PLOTSUMPERFIX(PLOT, FIX1, FIX2, FIX3,
FIX4, FIX5, FIX6, FIX7, FIX8, FIX9, FIX10)
VALUES(:PLOT, :FIX1, :FIX2, :FIX3, :FIX4,
:FIX5, :FIX6, :FIX7, :FIX8, :FIX9, :FIX10)
;
LOOP 111;
LABEL 999;
SELECT * FROM ZCLA_PLOTSUMPERFIX
FORMAT '../../PLOTSUMPERFIX.TXT';
CLOSE PLOTCURSOR;
UNLINK ZCLA_PLOTSUMPERFIX;
