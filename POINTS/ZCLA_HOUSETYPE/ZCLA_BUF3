INSERT INTO ZCLA_SITEFIX
(DOC , FIXID)
SELECT :DOC , FIXID
FROM ZCLA_FIXES
WHERE 0=0
AND   FIX <> '-1'
AND   FIXID > 0
;
UPDATE ZCLA_SITEFIX
SET   MOD_ST = 1
WHERE   DOC = :DOC
;
/* Site Uplifts
*/
:NAME = '';
:FIXID = 0 ;
:LABPOINT = 1.0 ;
:MOD_HT = :STUPLIFT = 0.0 ;
/* Cursor
*/
DECLARE @ST CURSOR FOR
SELECT ZCLA_SITEFIXUPLIFTS.UPLIFT
,   ZCLA_SITEFIXUPLIFTS.FIXID
,   STRCAT(ZCLA_SITECHARS.CHARNAME ,
'|' , ZCLA_SITEPERMITVALS.VALUE)
FROM ZCLA_SITEATTRIB , ZCLA_SITECHARS , ZCLA_SITEPERMITVALS ,
ZCLA_SITEFIXUPLIFTS
WHERE 0=0
AND   ZCLA_SITEATTRIB.CHARID = ZCLA_SITECHARS.CHARID
AND   ZCLA_SITEPERMITVALS.VALUEID = ZCLA_SITEATTRIB.VALUEID
AND   ZCLA_SITEFIXUPLIFTS.VALUEID  = ZCLA_SITEPERMITVALS.VALUEID
AND   DOC = :DOC
AND   ZCLA_SITEFIXUPLIFTS.UPLIFT <> 0
AND   INACTIVE <> 'Y'
;
OPEN @ST ;
GOTO 999 WHERE :RETVAL = 0 ;
LABEL 500;
FETCH @ST INTO :STUPLIFT , :FIXID , :NAME ;
GOTO 600 WHERE :RETVAL = 0;
/*
*/
SELECT MOD_ST INTO :MOD_ST
FROM ZCLA_SITEFIX
WHERE 0=0
AND   FIXID = :FIXID
AND   DOC = :DOC
;
UPDATE ZCLA_SITEFIX
SET MOD_ST = :MOD_ST * :STUPLIFT
WHERE 0=0
AND   FIXID = :FIXID
AND   DOC = :DOC
;
LOOP 500;
LABEL 600;
CLOSE @ST ;
LABEL 999;
