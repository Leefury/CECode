/*
*/
#INCLUDE func/ZCLA_DEBUGUSR
SELECT 'ZCLA_ELEDIT/PACKAGENAME/POST-FIELD'
, :$1.@ , :$.@
FROM DUMMY
WHERE :DEBUG = 1
FORMAT ADDTO :DEBUGFILE
;
GOTO 99 WHERE :$1.@ = :$.@ ;
GOTO 99 WHERE NOT EXISTS(
SELECT 'x'
FROM PART
WHERE 0=0
AND   PARTNAME = :$.@
AND   ZCLA_ISUPGRADE = 'Y'
);
:PART = 0 ;
SELECT PART INTO :PART
FROM PART
WHERE 0=0
AND   PARTNAME = :$.@
AND   ZCLA_ISUPGRADE = 'Y'
;
SELECT 'ZCLA_ELEDIT/PACKAGENAME/POST-FIELD'
, :PART , :$.EDITID , :$.PROJACT
FROM DUMMY
WHERE :DEBUG = 1
FORMAT ADDTO :DEBUGFILE
;
SELECT 'ZCLA_ELEDIT/PACKAGENAME/POST-FIELD'
, '>> Update split'
FROM DUMMY
WHERE :DEBUG = 1
FORMAT ADDTO :DEBUGFILE
;
DELETE FROM ZCLA_ELEDITSPLIT
WHERE EDITID = :$.EDITID
;
INSERT INTO ZCLA_ELEDITSPLIT(
PROJACT , FIXID , SPLIT , EDITID)
SELECT :$.PROJACT
,      FIXID
,      SPLIT
,      :$.EDITID
FROM ZCLA_PARTSPLIT
WHERE 0=0
AND   PART = :PART
;
SELECT  PARTPRICE.PRICE INTO :$.PACKAGEPRICE
FROM PARTPRICE , PART
WHERE 0=0
AND PARTPRICE.PART = PART.PART
AND PLIST = -1
AND PARTPRICE.QUANT = 1000
AND PART.ZCLA_ISUPGRADE = 'Y'
AND PART.PARTNAME = :$.@
;
LABEL 99 ;
SELECT 'ZCLA_ELEDIT/PACKAGENAME/POST-FIELD'
, 'End'
FROM DUMMY
WHERE :DEBUG = 1
FORMAT ADDTO :DEBUGFILE
;
